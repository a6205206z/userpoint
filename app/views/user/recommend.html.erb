<% content_for :application do %>
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<style>
    body{
        padding: 0;
        margin: 0;

        font-family: "Microsoft YaHei UI";
    }
    .split{
        background-color: #eaf6fd;
        height:15px;
    }
    .container{
        position: relative;
        background-image: url('/assets/background.png');
        background-repeat:no-repeat;
        background-position:center bottom;
        background-size: 65%;
        position: absolute;
        top:0;
        left:0;
        right:0;
        bottom:0;
    }
    .topbar{
        background-color: #fefefe;
        line-height: 50px;
        color:#172f5e;
    }
    .topbar .returnBtn{
        position: absolute;
        top:0;
        left:28px;
    }
    .topbar .returnBtn:before{
        content: "<";
        left:-14px;
        position: absolute;
        font-weight: bold;
        transform:scaleY(1.5);
    }
    .topbar .title{
        margin:0;
        text-align: center;
    }

    .section{
        background: transparent;

        border-top:1px solid rgba(160,247,246,0.8);
    }
    .section .textpanel{
        padding: 60px 30px 40px;
        font-size:14px;
    }
    .section .textpanel p {
        margin: 5px 0 0;
        text-align: center;
    }
    .section .textpanel p .codeMain{
        width: 80px;
    }
    .section .textpanel p .codetext{
        width: 125px;
    }
    .section .textpanel p .code{
        width: 160px;
        font-size:20px;
        border:1px solid #a0d9f6;
        text-align: center;
        padding: 5px;
    }
    .section .textpanel p .detailinfo{
        text-decoration: none;
        color:#a0d9f6;
    }
    .section .textpanel p .codebutton{
        margin: 10px  0 100px 0;
        width: 180px;
    }
    .text12{
        font-size:12px;
        color:#7e7e7e;
    }
    .text20{
        font-size:20px;
        color:#172f5e;
        font-weight: bold;
    }
    .text16{
        font-size:16px;
        width:180px;
        color:#333;
        margin: 5px auto!important;
        text-align: left!important;
    }
    .text16 span span{
        color:#e40082;
        font-weight: bold;
    }
    .send{
        margin-top: 30px!important;
    }
    .btn{

        width:180px;
        padding: 10px 0;
        display: block;
        background-color:#e40082;
        color:white;
        margin: 0 auto;
        text-decoration: none;
    }
</style>
<div class="container">
    <!--<div class="topbar">-->
    <!--<a class="returnBtn">返回</a>-->
    <!--<h4 class="title">活动规则</h4>-->
    <!--</div>-->
    <div class="split"></div>
    <div class="section">
        <div class="textpanel">
            <p><img src="/assets/icon-recommend.png" class="codeMain" /></p>
            <p class="text12">分享您的优惠码</p>
            <p class="text20">
        		<% if !@user_code_my.nil? %>
			       优惠代码:<%=@user_code_my.code %>
			       <input type="hidden" id="mycode" value="<%=@user_code_my.code %>" />
			    <% else %>
			   		成为正式会员，获取优惠代码。
			    <% end %>
            </p>
            <p class="text16"><span>当您的朋友使用优惠码购车,您将获得<span>500</span>积分</span></p>
            <p><a class="detailinfo" href="#">详细信息</a></p>
            <p class="send"><a class="btn" href="#">发送给朋友</a></p>
        </div>
    </div>
</div>
<script type="text/javascript">
    wx.config({
	    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
	    appId: 'wxf2a99d77725215d1', // 必填，公众号的唯一标识
	    timestamp: <%= @timestamp %>, // 必填，生成签名的时间戳
	    nonceStr: '<%= @noncestr %>', // 必填，生成签名的随机串
	    signature: '<%= @signature %>',// 必填，签名，见附录1
	    jsApiList: ['onMenuShareTimeline'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
	});
    // 当微信内置浏览器完成内部初始化后会触发WeixinJSBridgeReady事件。
    document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
    	wx.onMenuShareTimeline({
		    title: '礼享家-快使用我的专属代码【<%=@user_code_my.code %>】享受优惠吧', // 分享标题
		    link: 'http://wx.cd-peugeot.com/user/index', // 分享链接
		    imgUrl: 'http://wx.cd-peugeot.com/assets/logo.png', // 分享图标
		    success: function () { 
		        // 用户确认分享后执行的回调函数
		    },
		    cancel: function () { 
		        //alert("cancel");// 用户取消分享后执行的回调函数
		    }
		});
        
    }, false);
</script>
<% end %>